(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7485dd2e"],{"17ce":function(e,t,s){},"189f":function(e,t,s){"use strict";s("17ce")},d267:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dbhc"},[t("header",[e._v(" 风险等级评估儿童列表 ")]),t("div",{staticClass:"searchBox"},[t("van-sticky",[t("van-dropdown-menu",{attrs:{"active-color":"#1989fa"}},[t("van-dropdown-item",{attrs:{options:e.option2},on:{change:e.changeEvent},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}}),t("van-dropdown-item",{attrs:{title:"搜索"}},[t("van-cell",[t("van-search",{attrs:{"show-action":"",placeholder:"请输入姓名/身份证号码"},on:{search:e.onSearch},scopedSlots:e._u([{key:"action",fn:function(){return[t("div",{on:{click:e.onSearch}},[e._v("搜索")])]},proxy:!0}]),model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),t("van-cell",[t("div",{staticStyle:{padding:"5px 16px"}},[t("van-uploader",{staticStyle:{width:"100%",display:"block"},attrs:{"before-read":e.beforeRead,"after-read":e.uploadImg("idCard")}},[t("van-button",{staticStyle:{width:"100%",display:"block"},attrs:{size:"small",block:"",type:"info","native-type":"button"}},[e._v("拍照识别 ")])],1)],1)])],1)],1)],1)],1),t("main",[t("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[t("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.childrenList,(function(s,a){return t("div",{key:a,staticClass:"pg",on:{click:function(t){return e.routerPush(s.id,a)}}},[t("van-cell-group",[t("van-cell",[t("van-row",[t("van-col",{attrs:{span:"24"}},[t("span",{staticStyle:{color:"#333333","margin-left":"0px"}},[e._v("任务ID："+e._s(s.taskSubId))])])],1),t("van-row",[t("van-col",{attrs:{span:"17"}},[t("span",{staticStyle:{color:"#333333"}},[e._v(" 姓名："+e._s(s.name)+" ")])]),t("van-col",{attrs:{span:"7"}},[t("span",{staticStyle:{"margin-left":"10px"}},[s.level&&-1!=s.level.indexOf("一级")?t("van-tag",{attrs:{size:"medium",type:"danger"}},[e._v(e._s(s.level))]):s.level&&-1!=s.level.indexOf("二级")?t("van-tag",{attrs:{size:"medium",type:"warning"}},[e._v(e._s(s.level))]):s.level&&-1!=s.level.indexOf("三级")?t("van-tag",{attrs:{size:"medium",type:"primary"}},[e._v(e._s(s.level))]):s.level&&-1!=s.level.indexOf("四级")?t("van-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(s.level))]):t("van-tag",{attrs:{size:"medium",color:"#aaa"}},[e._v("未完成")])],1)])],1),t("van-row",[t("van-col",{attrs:{span:"24"}},[t("span",{staticStyle:{color:"#333333","margin-left":"0px"}},[e._v("身份证号："+e._s(s.idCard.replace(/(\w{4})\w*(\w{4})/,"$1****$2")))])])],1)],1)],1)],1)})),0)],1)],1)])},i=[],l=s("b775"),o=s("fa7d"),n={name:"hc",props:["headername","jz"],data(){return{childrenList:[],pageNo:0,pageSize:"5",loading:!1,finished:!1,refreshing:!1,searchValue:"",searchName:"",searchidCard:"",value1:"",value2:"评估状态",searchData:"",option2:[{text:"评估状态",value:"评估状态"},{text:"全部",value:"全部"},{text:"完成",value:"完成"},{text:"未完成",value:"未完成"}],fileList2:[],options:[]}},created(){Object(l["a"])({method:"post",url:"/social/assistanceWeixin/getCitys",data:{}}).then(e=>{console.log(e,"接口区划");for(let t in e){this.options.push({text:"",value:"",children:[]}),this.options[t].text=e[t].n.split("#")[0],this.options[t].value="#"+e[t].n.split("#")[1];for(let s in e[t].c){this.options[t].children[s]={text:"",value:"",children:[]},this.options[t].children[s].text=e[t].c[s].n.split("#")[0],this.options[t].children[s].value="#"+e[t].c[s].n.split("#")[1];for(let a in e[t].c[s].a)this.options[t].children[s].children[a]={text:"",value:""},this.options[t].children[s].children[a].text=e[t].c[s].a[a].split("#")[0],this.options[t].children[s].children[a].value="#"+e[t].c[s].a[a].split("#")[1]}}console.log(this.options,"区划")}).catch(e=>{console.log(e,"xzqh"),this.$toast.fail("数据请求失败1")})},watch:{},methods:{changeEvent(){console.log(this.value2),this.pageNo=0,"评估状态"==this.value2||"全部"==this.value2?this.value1="":"未完成"==this.value2?this.value1="未完成":"完成"==this.value2&&(this.value1="完成"),this.onRefresh()},loadData(e){return Object(l["a"])({method:"post",url:"/social/childEvaluate/getChildList",data:e,headers:{token:sessionStorage.getItem("token")}})},onLoad(){this.refreshing&&(this.childrenList=[],this.pageNo=0),this.loading=!1,this.loadData({pageNo:this.pageNo.toString(),pageSize:this.pageSize.toString()}).then(e=>{this.refreshing=!1,console.log(e,"res"),console.log(e,"res"),"+OK"==e.status?this.childrenList=e.data.content:(this.$toast.fail("数据加载失败"),console.log("loadData数据加载失败")),this.loading=!1,this.pageNo++,console.log(this.childrenList,"儿童列表"),console.log(this.pageNo),0==this.childrenList.length&&(this.finished=!0)}).catch(e=>{console.log(e)})},onRefresh(){this.finished=!1,this.childrenList=[],this.loading=!0,this.onLoad()},onSearch(){this.refreshing=!0,this.searchidCard="",this.searchName="",""==Object(o["e"])(this.searchValue)?this.searchidCard=this.searchValue:this.searchName=this.searchValue,this.onRefresh()},routerPush(e,t){this.$router.push({path:"/kjetfxpg",query:{taskSubId:this.childrenList[t].taskSubId,recordId:this.childrenList[t].recordId}})},beforeRead(e){return"image/heic"!=e.type&&""!=e.type||(this.$toast.fail("照片格式不正确"),!1)},imgRequest(e,t,s,a){Object(l["a"])({method:"post",url:"/social/weixinMinios/fileUpload",data:e}).then(e=>{t.status="done",t.message="上传完成",console.log(e),-1!=s.indexOf("idCard")&&Object(l["a"])({method:"post",url:"/social/assistanceWeixin/idOrc",data:{img:t.content}}).then(e=>{if(console.log(e,"res"),"ok"==e[0].status)try{let t=e[0].data.words_result;console.log(t),"idCard"==s?(t["公民身份号码"].words=t["公民身份号码"].words.replace(/\s+/g,""),this.searchValue=t["公民身份号码"].words,this.onSearch()):this.$toast.fail("身份证对比信息不符,请上传正确的身份证1")}catch(t){console.log(t),this.fileList2.pop(),this.$toast.fail("身份证对比信息不符,请上传正确的身份证2")}else this.fileList2.pop(),this.$toast.fail("身份证对比信息不符,请上传正确的身份证3")}).catch(e=>{console.log(e)})}).catch(e=>{t.status="failed",t.message="上传失败",this.$toast.fail("上传失败"),console.log(e)})},uploadImg(e,t){return s=>{s.status="uploading",s.message="上传中...",console.log(s.file);new o["a"](s,e,this.imgRequest,t)}}}},r=n,c=(s("189f"),s("2877")),h=Object(c["a"])(r,a,i,!1,null,"2356c2cc",null);t["default"]=h.exports}}]);