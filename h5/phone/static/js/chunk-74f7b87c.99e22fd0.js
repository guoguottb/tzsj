(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74f7b87c"],{"5d66":function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return n}));var o=a("b775");const r=e=>Object(o["a"])({method:"POST",url:"/social/SocialWorkOperate/visitPersonRateService",data:e}),i=e=>Object(o["a"])({method:"POST",url:"/social/SocialWorkOperate/getNotFinishBatchList",data:e}),s=e=>Object(o["a"])({method:"POST",url:"/social/SocialWorkOperate/getRecordList",data:e}),n=e=>Object(o["a"])({method:"POST",url:"/social/SocialWorkOrder/createOrder",data:e})},"5f3b":function(e,t,a){"use strict";a("c4f4")},b775:function(e,t,a){"use strict";var o=a("bc3a"),r=a.n(o),i=a("a18c");let s=Object({NODE_ENV:"production",BASE_URL:"/phone/"}).baseURL;const n=r.a.create({baseURL:s,timeout:3e4});n.interceptors.request.use(e=>(sessionStorage.token&&(e.headers.token=sessionStorage.token),e),e=>{console.log(e),Promise.reject(e)}),n.interceptors.response.use(e=>"blob"==e.config.responseType?200==e.status?e:Promise.reject(error):200===e.status?e.data:407!==e.status?Promise.reject("error1"):void 0,e=>{if(console.log("err"+e),e.response)switch(e.response.data.message){case"401":console.log("token过期了，需要重新登录"),i["a"].replace({path:"/login",query:{redirect:i["a"].currentRoute.fullPath}})}return Promise.reject(e.response.data)}),t["a"]=n},c4f4:function(e,t,a){},d6e5:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"maxBox"},[t("header",[e._v(" 工单详情 ")]),t("van-field",{attrs:{autosize:"",rows:"1",type:"textarea",name:"工单内容",label:"工单内容",placeholder:"工单内容"},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content","string"===typeof t?t.trim():t)},expression:"formData.content"}}),t("van-field",{attrs:{readonly:"",clickable:"",name:"服务开始时间",value:e.formData.startTime,label:"服务开始时间",placeholder:"点击选择服务开始时间"},on:{click:function(t){return e.showTime("服务开始时间")}}}),t("van-field",{attrs:{readonly:"",clickable:"",name:"服务结束时间",label:"服务结束时间",placeholder:"点击选择服务结束时间",rules:[{required:!0,message:"请填写服务结束时间"}]},on:{click:function(t){return e.showTime("服务结束时间")}},model:{value:e.formData.endTime,callback:function(t){e.$set(e.formData,"endTime",t)},expression:"formData.endTime"}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[t("van-datetime-picker",{attrs:{type:"datetime","min-date":new Date(2020,0,1),"max-date":new Date(2025,10,1)},on:{confirm:e.onConfirm,cancel:function(t){e.showPicker=!1}}})],1),t("div",{staticClass:"typeface"},[t("a",{attrs:{href:"#"},on:{click:e.addGuardian}},[e._v("新增走访任务")])]),e._l(e.formData.details,(function(a,o){return t("div",{key:a.NO},[t("van-divider",[e._v("走访任务"+e._s(o+1))]),t("van-field",{attrs:{readonly:"",clickable:"",name:"上门服务时间",label:"上门服务时间",placeholder:"上门服务时间"},on:{click:function(t){return e.showTime("上门服务时间",o)}},model:{value:a.serviceTime,callback:function(t){e.$set(a,"serviceTime",t)},expression:"Item.serviceTime"}}),t("van-field",{attrs:{type:"number",label:"服务时长",placeholder:"请输入服务时长（单位/分钟）"},model:{value:a.serviceDuration,callback:function(t){e.$set(a,"serviceDuration",t)},expression:"Item.serviceDuration"}}),t("van-field",{attrs:{autosize:"",rows:"1",type:"textarea",name:"服务描述",label:"服务描述",placeholder:"请填写服务描述"},model:{value:a.detail,callback:function(t){e.$set(a,"detail","string"===typeof t?t.trim():t)},expression:"Item.detail"}}),o+1===e.formData.details.length?t("div",{staticClass:"typeface"},[t("a",{staticStyle:{color:"#FF976A"},attrs:{href:"#"},on:{click:function(t){return e.deleteGuardian(a)}}},[e._v("删除服务记录")])]):e._e()],1)})),t("div",{staticClass:"footBtn"},[t("van-button",{staticStyle:{backgroundColor:"#3E80CC"},attrs:{block:"",type:"info"},on:{click:e.onSave}},[e._v("保存")])],1)],2)},r=[],i=a("5a0c"),s=a.n(i),n=a("5d66"),c={name:"WorkOrderDetails",data(){return{formData:{personId:this.$route.query.personId,familyId:this.$route.query.familyId,content:"",startTime:"",endTime:"",details:[]},showPicker:!1}},methods:{onSubmit(e){console.log("submit",e)},addGuardian(){if(this.formData.details.length>=20)return this.$toast("新增走访任务数量最多为20条");let e=this.formData.details.length?this.formData.details[this.formData.details.length-1].visitNo+1:1;this.formData.details.push({serviceDuration:"",serviceTime:"",detail:"",visitNo:e})},deleteGuardian(e){this.formData.details=this.formData.details.filter(t=>t.visitNo!==e.visitNo)},showTime(e,t){this.arrIndex=t,this.option=e,this.showPicker=!0},onConfirm(e){"服务开始时间"===this.option&&(this.formData.startTime=s()(e).format("YYYY-MM-DD HH:mm:ss")),"服务结束时间"===this.option&&(this.formData.endTime=s()(e).format("YYYY-MM-DD HH:mm:ss")),"上门服务时间"===this.option&&this.$set(this.formData.details[this.arrIndex],"serviceTime",s()(e).format("YYYY-MM-DD HH:mm:ss")),this.showPicker=!1},async onSave(){try{const e=await Object(n["a"])(this.formData);if(200!==e.code)return this.$toast.fail(e.msg);this.$toast.success(e.msg),this.$router.go(-1)}catch(error){console.log(error,"创建工单报错信息")}}}},l=c,d=(a("5f3b"),a("2877")),u=Object(d["a"])(l,o,r,!1,null,"2ff80692",null);t["default"]=u.exports}}]);